# ===============================
# ğŸš€ Clashé…ç½®æ–‡ä»¶ï¼ˆè¯¦ç»†æ•™å­¦æ³¨é‡Šç‰ˆï¼‰
# ç‰ˆæœ¬ï¼šä¼˜åŒ–æ•´ç†ç‰ˆ
# ===============================

# âœ¨ èŠ‚ç‚¹è®¢é˜…ï¼ˆproxy-providersï¼‰
proxy-providers:
  Longmao:
    # è®¢é˜…é“¾æ¥ï¼ˆæœºåœºæä¾›çš„è®¢é˜…åœ°å€ï¼‰
    url: ""
    type: http          # ä½¿ç”¨HTTPæ–¹å¼æ‹‰å–
    interval: 86400     # æ¯86400ç§’ï¼ˆä¸€å¤©ï¼‰è‡ªåŠ¨æ›´æ–°
    health-check:       # èŠ‚ç‚¹å¥åº·æ£€æŸ¥ï¼ˆæ£€æµ‹å¯ç”¨æ€§ï¼‰
      enable: true
      url: https://www.gstatic.com/generate_204
      interval: 21600    # æ¯360åˆ†é’Ÿæµ‹é€Ÿä¸€æ¬¡
    proxy: ç›´è¿          # æ‹‰å–è®¢é˜…æ—¶èµ°ç›´è¿ï¼Œä¸ç»è¿‡ä»£ç†

# âœ¨ æœ¬åœ°è‡ªå®šä¹‰èŠ‚ç‚¹ï¼ˆproxiesï¼‰
proxies:
  - name: ç›´è¿
    type: direct        # ç›´è¿ï¼Œä¸ç»è¿‡ä»»ä½•ä»£ç†æœåŠ¡å™¨

# âœ¨ ç«¯å£è®¾ç½®ï¼ˆæœ¬åœ°ç›‘å¬ç«¯å£ï¼‰
port: 7890               # HTTPä»£ç†ç«¯å£
socks-port: 7891         # SOCKS5ä»£ç†ç«¯å£
redir-port: 7892         # Rediré€æ˜ä»£ç†ç«¯å£
mixed-port: 7893         # Mixedç«¯å£ï¼ˆæ”¯æŒHTTP/SOCKS5ï¼‰
tproxy-port: 7894        # TProxyé€æ˜ä»£ç†ç«¯å£ï¼ˆæ›´å¼ºçš„é€æ˜ä»£ç†ï¼‰

# âœ¨ å±€åŸŸç½‘ç›¸å…³
allow-lan: true          # å…è®¸å±€åŸŸç½‘è®¾å¤‡è®¿é—®ä»£ç†
bind-address: "*"        # ç›‘å¬æ‰€æœ‰IPï¼ˆ"*"è¡¨ç¤º0.0.0.0ï¼‰

# âœ¨ ç½‘ç»œæ ˆä¼˜åŒ–
ipv6: false              # ç¦ç”¨IPv6ï¼ˆé™¤éæ˜ç¡®éœ€è¦ï¼Œä¸å»ºè®®å¼€å¯ï¼‰
unified-delay: true      # å¯ç”¨ç»Ÿä¸€å»¶è¿Ÿï¼Œæé«˜è¿æ¥ä½“éªŒ
tcp-concurrent: true     # TCPå¹¶å‘è¿æ¥ï¼ˆæ›´å¿«å»ºç«‹è¿æ¥ï¼‰
find-process-mode: 'off' # ç¦ç”¨è¿›ç¨‹æŸ¥æ‰¾ï¼ˆçœèµ„æºï¼‰

# âœ¨ æŒ‡çº¹ä¼ªè£…ï¼ˆåæ£€æµ‹ï¼‰
global-client-fingerprint: chrome  # ä¼ªè£…æˆChromeæµè§ˆå™¨

# âœ¨ ä¿æ´»è®¾ç½®ï¼ˆé•¿è¿æ¥ä¼˜åŒ–ï¼‰
keep-alive-idle: 600               # è¿æ¥ç©ºé—²ä¿æŒæ—¶é—´ï¼ˆç§’ï¼‰
keep-alive-interval: 15             # ä¿æ´»æ¢æµ‹åŒ…é—´éš”ï¼ˆç§’ï¼‰
disable-keep-alive: false           # å¯ç”¨keep-alive

# âœ¨ é…ç½®å­˜å‚¨é€‰é¡¹
profile:
  store-selected: true    # è®°ä½ä¸Šæ¬¡é€‰æ‹©çš„èŠ‚ç‚¹
  store-fake-ip: true      # è®°ä½fake-ipåˆ†é…ç»“æœ

# âœ¨ æ§åˆ¶é¢æ¿è®¾ç½®
external-controller: 0.0.0.0:9090   # æ§åˆ¶é¢æ¿ç›‘å¬åœ°å€ä¸ç«¯å£
secret: ""                          # æ§åˆ¶é¢æ¿å¯†ç ï¼ˆä¸ºç©ºè¡¨ç¤ºä¸è®¾ç½®ï¼‰
external-ui: "/etc/mihomo/run/ui"    # æœ¬åœ°UIè·¯å¾„
external-ui-name: zashboard         # UIåç§°ï¼ˆè¿™é‡Œæ˜¯Zashboardï¼‰
external-ui-url: "https://github.com/Zephyruso/zashboard/archive/refs/heads/gh-pages.zip"
# å¦‚æœæœ¬åœ°æ²¡æœ‰UIï¼Œä¼šè‡ªåŠ¨ä»è¿™ä¸ªåœ°å€ä¸‹è½½é¢æ¿

# âœ¨ å—…æ¢å™¨ï¼ˆsnifferï¼‰åŠŸèƒ½
sniffer:
  enable: true             # å¼€å¯å—…æ¢ï¼ˆæŠ“å–æµé‡ä¸­çš„åŸŸåä¿¡æ¯ï¼‰
  sniff:
    HTTP:
      ports: [80, 8080-8880]         # æŒ‡å®šå—…æ¢HTTPç«¯å£
      override-destination: true    # è¦†ç›–ç›®æ ‡åœ°å€
    TLS:
      ports: [443, 8443]             # æŒ‡å®šå—…æ¢HTTPSç«¯å£
    QUIC:
      ports: [443, 8443]             # æŒ‡å®šå—…æ¢QUICç«¯å£
  force-domain:
    - "+.v2ex.com"         # å¼ºåˆ¶å—…æ¢çš„åŸŸå
  skip-domain:
    - "+.baidu.com"        # è·³è¿‡å—…æ¢çš„åŸŸåï¼ˆæå‡æ€§èƒ½ï¼‰

# âœ¨ å…¥ç«™é…ç½®ï¼ˆtunæ¨¡å—ï¼Œå¼ºåˆ¶æµé‡åŠ«æŒï¼‰
tun:
  enable: true              # å¼€å¯Tunæ¨¡å¼
  stack: mixed              # ä½¿ç”¨æ··åˆæ¨¡å¼ï¼ˆsystem+gvisorç»“åˆï¼‰
  dns-hijack: ["any:53", "tcp://any:53"]  # åŠ«æŒDNSæŸ¥è¯¢è¯·æ±‚
  auto-route: true          # è‡ªåŠ¨æ·»åŠ è·¯ç”±è§„åˆ™
  auto-redirect: true       # è‡ªåŠ¨é‡å®šå‘æµé‡
  auto-detect-interface: true  # è‡ªåŠ¨æ¢æµ‹ç½‘å¡

# âœ¨ DNSæ¨¡å—ï¼ˆé‡è¦ï¼ç›´æ¥å½±å“æµé‡åˆ†æµï¼‰
dns:
  enable: true
  listen: 0.0.0.0:1053     # DNSæœåŠ¡ç›‘å¬åœ°å€å’Œç«¯å£
  ipv6: false              # å…³é—­IPv6æŸ¥è¯¢
  respect-rules: true      # æŒ‰ç…§Clashè§„åˆ™å¤„ç†DNSè¯·æ±‚
  enhanced-mode: fake-ip   # å¯ç”¨Fake-IPæ¨¡å¼ï¼ˆé€‚åˆè§£é”æµåª’ä½“ï¼‰
  fake-ip-range: 28.0.0.1/8
  fake-ip-filter-mode: blacklist
  fake-ip-filter:
    - "rule-set:private_domain,cn_domain" # å›½åŒºåŸŸåç›´è¿
    - "+.msftconnecttest.com"             # å¾®è½¯è¿é€šæ€§æµ‹è¯•
    - "+.msftncsi.com"
    - "time.*.com"
  default-nameserver:
    - 223.5.5.5         # é»˜è®¤DNSï¼ˆé˜¿é‡Œå…¬å…±DNSï¼‰
  proxy-server-nameserver:
    - https://223.5.5.5/dns-query  # ç”¨äºä»£ç†æœåŠ¡å™¨å†…éƒ¨DNS
  nameserver:
    - 61.128.128.68     # æœ¬åœ°è¿è¥å•†DNSï¼ˆæ¨èï¼‰
    - 61.128.192.68
    
# å‡ºç«™ç­–ç•¥
# æ³¨æ„ï¼šé”šç‚¹å¿…é¡»æ”¾åœ¨å¼•ç”¨ä¹‹å‰
pr: &pr
  type: select
  proxies:
    - ğŸš€ é»˜è®¤ä»£ç†
    - â™»ï¸ è‡ªåŠ¨é€‰æ‹©
    - ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹
    - ğŸ‡¹ğŸ‡¼ å°æ¹¾èŠ‚ç‚¹
    - ğŸ‡¸ğŸ‡¬ æ–°åŠ å¡èŠ‚ç‚¹
    - ğŸ‡¯ğŸ‡µ æ—¥æœ¬èŠ‚ç‚¹
    - ğŸ‡ºğŸ‡² ç¾å›½èŠ‚ç‚¹
    - ğŸ‡²ğŸ‡¾ é©¬æ¥è¥¿äºšèŠ‚ç‚¹
    - ğŸŒ å…¨éƒ¨èŠ‚ç‚¹
    - ç›´è¿

proxy-groups:
  - name: ğŸš€ é»˜è®¤ä»£ç†
    type: select
    proxies:
      - â™»ï¸ è‡ªåŠ¨é€‰æ‹©
      - ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹
      - ğŸ‡¹ğŸ‡¼ å°æ¹¾èŠ‚ç‚¹
      - ğŸ‡¸ğŸ‡¬ æ–°åŠ å¡èŠ‚ç‚¹
      - ğŸ‡¯ğŸ‡µ æ—¥æœ¬èŠ‚ç‚¹
      - ğŸ‡ºğŸ‡² ç¾å›½èŠ‚ç‚¹
      - ğŸ‡²ğŸ‡¾ é©¬æ¥è¥¿äºšèŠ‚ç‚¹
      - ğŸŒ å…¨éƒ¨èŠ‚ç‚¹
      - ç›´è¿

  - name: ğŸ“¹ YouTube
    <<: *pr

  - name: ğŸ€ Google
    <<: *pr

  - name: ğŸ“· Instagram
    <<: *pr

  - name: ğŸ“˜ Facebook
    <<: *pr

  - name: ğŸ¦ Twitter
    <<: *pr

  - name: ğŸ¤– ChatGPT
    <<: *pr

  - name: ğŸ‘¨ğŸ¿â€ğŸ’» GitHub
    <<: *pr

  - name: ğŸ¬ OneDrive
    <<: *pr

  - name: ğŸªŸ Microsoft
    <<: *pr

  - name: ğŸµ TikTok
    <<: *pr

  - name: ğŸ“² Telegram
    <<: *pr

  - name: ğŸ¥ NETFLIX
    <<: *pr

  - name: âœˆï¸ Speedtest
    <<: *pr

  - name: ğŸ’¶ PayPal
    <<: *pr

  - name: ğŸ Apple
    type: select
    proxies:
      - ç›´è¿
      - ğŸš€ é»˜è®¤ä»£ç†

  - name: ğŸ¯ ç›´è¿
    type: select
    proxies:
      - ç›´è¿
      - ğŸš€ é»˜è®¤ä»£ç†

  - name: ğŸŸ æ¼ç½‘ä¹‹é±¼
    <<: *pr

  # åŒºåŸŸèŠ‚ç‚¹ç­›é€‰
  - name: ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹
    type: select
    include-all: true
    filter: "(?i)æ¸¯|hk|hongkong|hong kong"

  - name: ğŸ‡¹ğŸ‡¼ å°æ¹¾èŠ‚ç‚¹
    type: select
    include-all: true
    filter: "(?i)å°|tw"

  - name: ğŸ‡¸ğŸ‡¬ æ–°åŠ å¡èŠ‚ç‚¹
    type: select
    include-all: true
    filter: "(?i)å¡|sg"

  - name: ğŸ‡¯ğŸ‡µ æ—¥æœ¬èŠ‚ç‚¹
    type: select
    include-all: true
    filter: "(?i)æ—¥|jp|japan"

  - name: ğŸ‡ºğŸ‡² ç¾å›½èŠ‚ç‚¹
    type: select
    include-all: true
    filter: "(?i)ç¾|us|unitedstates|united states"

  - name: ğŸ‡²ğŸ‡¾ é©¬æ¥è¥¿äºšèŠ‚ç‚¹
    type: select
    include-all: true
    filter: "(?i)é©¬|my"

  # è‡ªåŠ¨æµ‹é€Ÿé€‰æ‹©èŠ‚ç‚¹
  - name: â™»ï¸ è‡ªåŠ¨é€‰æ‹©
    type: url-test
    include-all: true
    tolerance: 20
    interval: 300
    filter: "^((?!(ç›´è¿)).)*$"

  - name: ğŸŒ å…¨éƒ¨èŠ‚ç‚¹
    type: select
    include-all: true

# è§„åˆ™åŒ¹é…
rules:
  - RULE-SET,private_domain,ç›´è¿
  - RULE-SET,apple_domain,ğŸ Apple
  - RULE-SET,proxylite,ğŸš€ é»˜è®¤ä»£ç†
  - RULE-SET,ai,ğŸ¤– ChatGPT
  - RULE-SET,github_domain,ğŸ‘¨ğŸ¿â€ğŸ’» GitHub
  - RULE-SET,youtube_domain,ğŸ“¹ YouTube
  - RULE-SET,google_domain,ğŸ€ Google
  - RULE-SET,instagram_domain,ğŸ“· Instagram
  - RULE-SET,facebook_domain,ğŸ“˜ Facebook
  - RULE-SET,twitter_domain,ğŸ¦ Twitter
  - RULE-SET,onedrive_domain,ğŸ¬ OneDrive
  - RULE-SET,microsoft_domain,ğŸªŸ Microsoft
  - RULE-SET,tiktok_domain,ğŸµ TikTok
  - RULE-SET,speedtest_domain,âœˆï¸ Speedtest
  - RULE-SET,telegram_domain,ğŸ“² Telegram
  - RULE-SET,netflix_domain,ğŸ¥ NETFLIX
  - RULE-SET,paypal_domain,ğŸ’¶ PayPal
  - RULE-SET,gfw_domain,ğŸš€ é»˜è®¤ä»£ç†
  - RULE-SET,geolocation-!cn,ğŸš€ é»˜è®¤ä»£ç†
  - RULE-SET,cn_domain,ğŸ¯ ç›´è¿
  - RULE-SET,google_ip,ğŸ€ Google,no-resolve
  - RULE-SET,netflix_ip,ğŸ¥ NETFLIX,no-resolve
  - RULE-SET,telegram_ip,ğŸ“² Telegram,no-resolve
  - RULE-SET,cn_ip,ğŸ¯ ç›´è¿
  - MATCH,ğŸŸ æ¼ç½‘ä¹‹é±¼
    
# è§„åˆ™é”šç‚¹å®šä¹‰
rule-anchor:
  ip: &ip
    type: http
    interval: 86400
    behavior: ipcidr
    format: mrs

  domain: &domain
    type: http
    interval: 86400
    behavior: domain
    format: mrs

  class: &class
    type: http
    interval: 86400
    behavior: classical
    format: text

# è§„åˆ™æä¾›è€… rule-providers
rule-providers:
  private_domain:
    <<: *domain
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/private.mrs"

  proxylite:
    <<: *class
    url: "https://raw.githubusercontent.com/alix-crypto/myroom/refs/heads/main/proxy.list"

  ai:
    <<: *domain
    url: "https://github.com/MetaCubeX/meta-rules-dat/raw/refs/heads/meta/geo/geosite/category-ai-!cn.mrs"

  youtube_domain:
    <<: *domain
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/youtube.mrs"

  google_domain:
    <<: *domain
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/google.mrs"

  instagram_domain:
    <<: *domain
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/instagram.mrs"

  facebook_domain:
    <<: *domain
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/facebook.mrs"

  twitter_domain:
    <<: *domain
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/twitter.mrs"

  github_domain:
    <<: *domain
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/github.mrs"

  telegram_domain:
    <<: *domain
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/telegram.mrs"

  netflix_domain:
    <<: *domain
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/netflix.mrs"

  paypal_domain:
    <<: *domain
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/paypal.mrs"

  onedrive_domain:
    <<: *domain
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/onedrive.mrs"

  microsoft_domain:
    <<: *domain
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/microsoft.mrs"

  apple_domain:
    <<: *domain
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/apple@cn.mrs"

  speedtest_domain:
    <<: *domain
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/ookla-speedtest.mrs"

  tiktok_domain:
    <<: *domain
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/tiktok.mrs"

  gfw_domain:
    <<: *domain
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/gfw.mrs"

  geolocation-!cn:
    <<: *domain
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/geolocation-!cn.mrs"

  cn_domain:
    <<: *domain
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/cn.mrs"

  cn_ip:
    <<: *ip
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geoip/cn.mrs"

  google_ip:
    <<: *ip
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geoip/google.mrs"

  telegram_ip:
    <<: *ip
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geoip/telegram.mrs"

  netflix_ip:
    <<: *ip
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geoip/netflix.mrs"
    
